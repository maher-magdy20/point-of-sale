"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var Order=function(){function t(){_classCallCheck(this,t),this._menu=[],this._previousSales=[],this._invoiceNumber="",this._order=[],this._payment={amountPaid:0,type:"",changeTip:0}}return _createClass(t,[{key:"generateInvoiceNumber",value:function(){if(this.previousSales.length<1||null==this.previousSales)this.invoiceNumber=1;else{var t=this.previousSales.map(function(t){return t[1]}).reduce(function(t,e){return Math.max(t,e)});this.invoiceNumber=t+1}}},{key:"addOrderLine",value:function(t,e){var n={},a=JSON.parse(e);n.sku=a.sku,n.description=a.description,n.quantity=t,n.price=Utilities.roundToTwo(parseFloat(a.price)),n.subtotal=n.quantity*n.price,n.tax=Utilities.roundToTwo(a.taxRate*n.subtotal),this.order.push(n),Ui.receiptDetails(this)}},{key:"deleteOrderLine",value:function(t){this.order.splice(t,1),Ui.receiptDetails(this)}},{key:"clearOrder",value:function(){this.order=[],Ui.receiptDetails(this)}},{key:"getSummary",value:function(){var e={subtotal:0,tax:0,grandtotal:0};return this.order.forEach(function(t){e.subtotal+=t.subtotal,e.tax+=t.tax}),e.grandtotal=e.subtotal+e.tax,e}},{key:"changePayment",value:function(t){var e=this.getSummary().grandtotal;null!=t.amountPaid&&(this.payment.amountPaid=parseFloat(t.amountPaid)),null!=t.type&&(this.payment.type=t.type),this.payment.amountPaid>=e?(this.payment.changeTip=this.payment.amountPaid-e,Ui.closeButton(!1)):(this.payment.changeTip=0,Ui.closeButton(!0)),Ui.paymentSummary(this)}},{key:"clearPayment",value:function(){this.payment={amountPaid:0,type:"",changeTip:0},Ui.paymentSummary(this)}},{key:"exportOrder",value:function(n){var a=this,i=[];return this.order.forEach(function(t){var e=[];e[0]=n,e[1]=a.invoiceNumber,e[2]=t.sku,e[3]=t.quantity,e[4]=t.price,e[5]=t.tax,i.push(e),a.previousSales.push(e)}),i}},{key:"exportPayment",value:function(t){var e=[[]],n=Utilities.roundToTwo(this.payment.amountPaid-this.getSummary().grandtotal);return e[0][0]=t,e[0][1]=this.invoiceNumber,e[0][2]=this.getSummary().grandtotal,e[0][3]=this.payment.type,"cash"==this.payment.type?e[0][4]=0:e[0][4]=n,e}},{key:"closeSale",value:function(){var t=new Date,e={order:this.exportOrder(t),payment:this.exportPayment(t)};Ui.hidePaypad(this),this.clearPayment(),this.clearOrder(),Ui.invoiceNumber(this),google.script.run.setData(JSON.stringify(e))}},{key:"menu",get:function(){return this._menu},set:function(t){var n=this;this._menu=[],t.forEach(function(t){var e={};e.sku=t[0],e.description=t[1],e.price=t[2],e.taxRate=t[3],e.image=t[4],n._menu.push(e)})}},{key:"previousSales",get:function(){return this._previousSales},set:function(t){this._previousSales=t}},{key:"invoiceNumber",get:function(){return this._invoiceNumber},set:function(t){this._invoiceNumber=t.toString()}},{key:"order",get:function(){return this._order},set:function(t){this._order=t}},{key:"payment",get:function(){return this._payment},set:function(t){this._payment=t}}]),t}(),Ui=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"menu",value:function(e){var i=document.createDocumentFragment();e.menu.forEach(function(t){var e='<img src="'.concat(t.image,'\'" alt="').concat(t.description,'" class="menu-img" style="width:150px;">\n            <figcaption>').concat(t.description,"</figcaption>\n            <figcaption>").concat(Utilities.convertFloatToString(t.price),"</figcaption>"),n=document.createElement("figure");n.className="menu-item";var a=JSON.stringify({sku:"".concat(t.sku),description:"".concat(t.description),price:"".concat(t.price),taxRate:"".concat(t.taxRate)});n.setAttribute("data-sku",a),n.innerHTML=e,i.appendChild(n)}),document.getElementById("menu").appendChild(i),document.querySelectorAll(".menu-item").forEach(function(t){t.addEventListener("click",function(){e.addOrderLine(1,t.getAttribute("data-sku"))})})}},{key:"receiptDetails",value:function(e){var i=document.createDocumentFragment();e.order.forEach(function(t,e){var n='<td class="description">'.concat(t.description,'</td>\n            <td class="quantity">').concat(t.quantity,'</td>\n            <td class="price">').concat(Utilities.convertFloatToString(t.price),'</td>\n            <td class="subtotal">').concat(Utilities.convertFloatToString(t.subtotal),'</td>\n            <td class="delete" data-delete="').concat(e.toString(),'"><i class="fas fa-backspace"></i></td>'),a=document.createElement("tr");a.setAttribute("data-index","".concat(e.toString())),a.innerHTML=n,i.appendChild(a)});for(var t=document.getElementById("receipt-details");t.hasChildNodes();)t.removeChild(t.childNodes[0]);t.appendChild(i),this.summary(e),document.querySelectorAll(".delete").forEach(function(t){t.addEventListener("click",function(){e.deleteOrderLine(parseInt(t.getAttribute("data-delete")))})})}},{key:"invoiceNumber",value:function(t){t.generateInvoiceNumber();var e=t.invoiceNumber;document.getElementById("invoice-number").textContent="Invoice# ".concat(e)}},{key:"summary",value:function(t){var e=t.getSummary(),n=document.getElementById("subtotal-summary"),a=document.getElementById("tax-summary"),i=document.getElementById("grandtotal-summary");n.textContent=Utilities.convertFloatToString(e.subtotal),a.textContent=Utilities.convertFloatToString(e.tax),i.textContent=Utilities.convertFloatToString(e.grandtotal)}},{key:"showPaypad",value:function(){document.getElementById("payment-overlay").style.display="grid"}},{key:"hidePaypad",value:function(){document.getElementById("payment-overlay").style.display="none"}},{key:"paymentSummary",value:function(t){document.getElementById("amount-paid").textContent=Utilities.convertFloatToString(t.payment.amountPaid);var e=document.getElementById("tip-change-title"),n=document.getElementById("payment-type");"credit"===t.payment.type?(e.textContent="Tip:",n.textContent="CC"):"cash"===t.payment.type?(e.textContent="Change:",n.textContent="Cash"):(e.textContent="Change:",n.textContent=""),document.getElementById("tip-change-value").textContent=Utilities.convertFloatToString(t.payment.changeTip)}},{key:"closeButton",value:function(t){var e=document.getElementById("close-sale");e.style.display=t?"none":"grid"}}]),t}(),Utilities=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"convertFloatToString",value:function(t){return t.toLocaleString("en-us",{style:"currency",currency:"EGP"})}},{key:"roundToTwo",value:function(t){return+(Math.round(t+"e+2")+"e-2")}},{key:"paypad",value:function(t,e){isNaN(parseInt(t))?"back"===t?this.backPaypad(e):"clear"===t?this.clearPaypad(e):e.closeSale():this.numberPaypad(parseInt(t),e)}},{key:"numberPaypad",value:function(t,e){var n=this.roundToTwo(.01*t),a=this.roundToTwo(e.payment.amountPaid),i=this.roundToTwo(10*a+n);0===a?e.changePayment({amountPaid:n}):e.changePayment({amountPaid:i})}},{key:"backPaypad",value:function(t){var e=t.payment.amountPaid;if(0<e){var n=.1*(e-100*e%10*.01);t.changePayment({amountPaid:n})}}},{key:"clearPaypad",value:function(t){t.changePayment({amountPaid:0})}}]),t}();document.getElementById("clear-order").addEventListener("click",function(){order.clearOrder()}),document.querySelectorAll(".paypad-show").forEach(function(t){t.addEventListener("click",function(){Ui.showPaypad(order),order.changePayment(JSON.parse(t.getAttribute("data-payment-type")))})}),document.getElementById("paypad-close").addEventListener("click",function(){order.clearPayment(),Ui.hidePaypad(order)}),document.querySelectorAll(".paypad-btn").forEach(function(t){t.addEventListener("click",function(){Utilities.paypad(t.getAttribute("data-id"),order)})});var mockMenuData=[[101,"Respiratory crisis apparatus",1790,.05,"https://i.ibb.co/8Y1RdSB/item-XL-115644440-c4a59ab70103a.jpg"],[102,"Pulse oximeter",420,.05,"https://i.ibb.co/vsKNttf/item-XL-22647870-31321654.jpg"],[103,"blood pressure monitor",999,.05,"https://i.ibb.co/YtvCN31/file-30-1.jpg"],[104,"30Â°Sheath two-stopcock",3360,.05,"https://i.ibb.co/zHGzfGZ/77052.jpg"],[105,"Steam inhalation device",469,.05,"https://i.ibb.co/YPsZkj3/nebulizator.jpg"],[106,"Asch Septum Fcps 23cm, S/S",1290,.05,"https://i.ibb.co/mNJ7tmP/586-1.png"],[107,"Brunings Septum forceps 16.5 cm",51,.05,"https://i.ibb.co/rGF5CHv/62284.png"],[108,"amalgamator",1225,.05,"https://i.ibb.co/XD8WXFz/bc0609b2-a743-42e0-8fe6-a1d33f7a1cd9.jpg"],[109,"Examination bed",750,.05,"https://i.ibb.co/tDPWzz4/13cdae11-60b9-412b-96f9-b7260001bc54.jpg"],[110,"Stretcher ",850,.05,"https://i.ibb.co/Bff3TgQ/54282.jpg"],[111,"Electrocardiograph",23650,.05,"https://i.ibb.co/qd0BWCV/52423.jpg"],[112,"EKG machine",6490,.05,"https://i.ibb.co/jbJCcZd/48085.jpg"],[113,"A trolley ambulance transforms into a chair",1850,.05,"https://i.ibb.co/BZ2NYXR/automatic-loading-stretcher-nf-a6-2-2.jpg"],[114,"Bedside cabinet",1260,.05,"https://i.ibb.co/TMF48bt/48777.jpg"],[115,"Childbirth Gynecology Table",21e3,.05,"https://i.ibb.co/VLd0hbk/81082.jpg"]],mockPreviousSalesData=[["",4999,101,1,10.99,.5495],["",4999,102,2,7.95,.3975],["",4999,103,3,8.96,.45],["",5e3,106,1,6.99,.35],["",5e3,107,1,5.95,.3]],mockPaymentsData=[["",4999,56.46,"cc",5],["",5e3,13.59,"cash",0]],order=new Order;order.menu=mockMenuData,order.previousSales=mockPreviousSalesData,Ui.menu(order);
//# sourceMappingURL=js.min.js.map
